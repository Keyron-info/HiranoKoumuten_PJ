# invoices/management/commands/init_construction_types.py
"""
å·¥ç¨®ãƒã‚¹ã‚¿ã‚’åˆæœŸåŒ–ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ï¼ˆ38ç¨®é¡ï¼‰

ä½¿ç”¨æ–¹æ³•:
  python manage.py init_construction_types
"""

from django.core.management.base import BaseCommand
from invoices.models import ConstructionType


class Command(BaseCommand):
    help = 'å·¥ç¨®ãƒã‚¹ã‚¿ã‚’åˆæœŸåŒ–ï¼ˆ38ç¨®é¡ã®å·¥ç¨®ã‚’ç™»éŒ²ï¼‰'

    def handle(self, *args, **options):
        # 38ç¨®é¡ã®å·¥ç¨®ã‚’å®šç¾©ï¼ˆè¦ä»¶å®šç¾©æ›¸v2.0æº–æ‹ ï¼‰
        initial_types = [
            # (code, name, description, display_order)
            ('direct_temporary', 'ç›´æ¥ä»®è¨­å·¥äº‹', 'ç¾å ´äº‹å‹™æ‰€ã€ä»®å›²ã„ã€è¶³å ´ã€ä»®è¨­é›»æ°—ãƒ»æ°´é“ãªã©', 1),
            ('earthwork', 'åœŸå·¥äº‹', 'æ˜å‰Šã€åŸ‹ã‚æˆ»ã—ã€æ®‹åœŸå‡¦åˆ†ã€åœ°ç›¤æ”¹è‰¯ãªã©', 2),
            ('pile', 'æ­å·¥äº‹', 'æ­æ‰“ã¡ã€åœ°ç›¤è£œå¼·å·¥äº‹ãªã©', 3),
            ('rebar', 'é‰„ç­‹å·¥äº‹', 'é‰„ç­‹åŠ å·¥ã€çµ„ç«‹ã€é…ç­‹ãªã©', 4),
            ('concrete', 'ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆå·¥äº‹', 'ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆæ‰“è¨­ã€é¤Šç”Ÿãªã©', 5),
            ('formwork', 'å‹æ å·¥äº‹', 'å‹æ çµ„ç«‹ã€è§£ä½“ãªã©', 6),
            ('steel', 'é‰„éª¨å·¥äº‹', 'é‰„éª¨è£½ä½œã€å»ºæ–¹ã€æ¥åˆãªã©', 7),
            ('waterproofing', 'é˜²æ°´å·¥äº‹', 'ã‚¢ã‚¹ãƒ•ã‚¡ãƒ«ãƒˆé˜²æ°´ã€ã‚·ãƒ¼ãƒˆé˜²æ°´ã€å¡—è†œé˜²æ°´ãªã©', 8),
            ('stone_tile', 'çŸ³ã‚¿ã‚¤ãƒ«å·¥äº‹', 'çŸ³æã€ã‚¿ã‚¤ãƒ«æ–½å·¥ãªã©', 9),
            ('alc', 'ALCå·¥äº‹', 'ALCç‰ˆè¨­ç½®ã€ç›®åœ°å‡¦ç†ãªã©', 10),
            ('roofing', 'å±‹æ ¹ç…™å·¥äº‹', 'å±‹æ ¹è‘ºãã€ç…™çªè¨­ç½®ãªã©', 11),
            ('plastering', 'å·¦å®˜å·¥äº‹', 'ãƒ¢ãƒ«ã‚¿ãƒ«å¡—ã‚Šã€ä»•ä¸Šã’å¡—ã‚Šãªã©', 12),
            ('metal', 'é‡‘å±å·¥äº‹', 'é‡‘å±è£½å“å–ä»˜ã€æ‰‹æ‘ºã€éšæ®µãªã©', 13),
            ('metal_fittings', 'é‡‘å±è£½å»ºå…·å·¥äº‹', 'ã‚¹ãƒãƒ¼ãƒ«ãƒ‰ã‚¢ã€ã‚·ãƒ£ãƒƒã‚¿ãƒ¼ã€æ‰‹æ‘ºãªã©', 14),
            ('wood_fittings', 'æœ¨è£½å»ºå…·å·¥äº‹', 'æœ¨è£½ãƒ‰ã‚¢ã€éšœå­ã€è¥–ãªã©', 15),
            ('glass', 'ç¡å­å·¥äº‹', 'ã‚¬ãƒ©ã‚¹è¨­ç½®ã€çª“ã‚¬ãƒ©ã‚¹ã€é¡ãªã©', 16),
            ('painting', 'å¡—è£…å·¥äº‹', 'å¡—è£…ã€å¹ä»˜ã‘ã€ã‚³ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãªã©', 17),
            ('carpentry', 'æœ¨å·¥äº‹', 'æœ¨é€ å·¥äº‹ã€é€ ä½œãªã©', 18),
            ('light_steel', 'è»½é‰„å·¥äº‹', 'è»½é‡é‰„éª¨ä¸‹åœ°ã€é–“ä»•åˆ‡ã‚Šãªã©', 19),
            ('covering', 'è¢«è¦†å·¥äº‹', 'è€ç«è¢«è¦†ã€æ–­ç†±æãªã©', 20),
            ('interior', 'å†…è£…å·¥äº‹', 'å£ç´™ã€ã‚¯ãƒ­ã‚¹ã€åºŠæãªã©', 21),
            ('exterior', 'å¤–è£…å·¥äº‹', 'å¤–å£ä»•ä¸Šã’ã€ã‚µã‚¤ãƒ‡ã‚£ãƒ³ã‚°ãªã©', 22),
            ('fixtures', 'ä»€å™¨å·¥äº‹', 'é€ ã‚Šä»˜ã‘å®¶å…·ã€ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãªã©', 23),
            ('furniture', 'å®¶å…·å·¥äº‹', 'å®¶å…·è£½ä½œã€è¨­ç½®ãªã©', 24),
            ('heating', 'æš–æˆ¿å™¨å…·å·¥äº‹', 'æš–æˆ¿è¨­å‚™ã€ãƒ’ãƒ¼ã‚¿ãƒ¼è¨­ç½®ãªã©', 25),
            ('unit', 'ãƒ¦ãƒ‹ãƒƒãƒˆå·¥äº‹', 'ãƒ¦ãƒ‹ãƒƒãƒˆãƒã‚¹ã€ã‚·ã‚¹ãƒ†ãƒ ã‚­ãƒƒãƒãƒ³ãªã©', 26),
            ('misc', 'é›‘å·¥äº‹', 'ãã®ä»–ä»˜å¸¯å·¥äº‹ãªã©', 27),
            ('electrical', 'é›»æ°—è¨­å‚™å·¥äº‹', 'é›»æ°—é…ç·šã€ç…§æ˜ã€ã‚³ãƒ³ã‚»ãƒ³ãƒˆã€åˆ†é›»ç›¤ãªã©', 28),
            ('plumbing', 'çµ¦æ’æ°´è¡›ç”Ÿè¨­å‚™å·¥äº‹', 'çµ¦æ°´ã€æ’æ°´ã€è¡›ç”Ÿå™¨å…·ãªã©', 29),
            ('hvac', 'ç©ºèª¿æ›æ°—è¨­å‚™å·¥äº‹', 'ã‚¨ã‚¢ã‚³ãƒ³ã€æ›æ°—æ‰‡ã€ãƒ€ã‚¯ãƒˆãªã©', 30),
            ('elevator', 'EVå·¥äº‹', 'ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼è¨­ç½®ã€ä¿å®ˆãªã©', 31),
            ('mechanical', 'æ©Ÿæ¢°è¨­å‚™å·¥äº‹', 'æ©Ÿæ¢°è¨­å‚™ã€ç”Ÿç”£è¨­å‚™ãªã©', 32),
            ('other_equipment', 'ãã®ä»–è¨­å‚™å·¥äº‹', 'ãã®ä»–ã®è¨­å‚™å·¥äº‹', 33),
            ('exterior_site', 'å¤–æ§‹å·¥äº‹', 'é–€æ‰‰ã€ãƒ•ã‚§ãƒ³ã‚¹ã€èˆ—è£…ã€æ¤æ ½ãªã©', 34),
            ('demolition', 'è§£ä½“å·¥äº‹', 'å»ºç‰©è§£ä½“ã€æ’¤å»å·¥äº‹ãªã©', 35),
            ('other', 'ãã®ä»–å·¥äº‹', 'ä¸Šè¨˜ã«åˆ†é¡ã•ã‚Œãªã„ãã®ä»–å·¥äº‹', 36),
            ('reserve1', 'ï¼ˆäºˆå‚™1ï¼‰', 'å°†æ¥ã®è¿½åŠ ç”¨', 37),
            ('reserve2', 'ï¼ˆäºˆå‚™2ï¼‰', 'å°†æ¥ã®è¿½åŠ ç”¨', 38),
        ]

        created_count = 0
        updated_count = 0

        self.stdout.write(self.style.MIGRATE_HEADING('å·¥ç¨®ãƒã‚¹ã‚¿ã‚’åˆæœŸåŒ–ä¸­...'))
        self.stdout.write('')

        for code, name, description, order in initial_types:
            obj, created = ConstructionType.objects.update_or_create(
                code=code,
                defaults={
                    'name': name,
                    'description': description,
                    'display_order': order,
                    'is_active': True if not code.startswith('reserve') else False,
                }
            )
            if created:
                created_count += 1
                self.stdout.write(f'  âœ… ä½œæˆ: {order:02d}. {name}')
            else:
                updated_count += 1
                self.stdout.write(f'  ğŸ”„ æ›´æ–°: {order:02d}. {name}')

        self.stdout.write('')
        self.stdout.write(self.style.SUCCESS(
            f'å·¥ç¨®ãƒã‚¹ã‚¿ã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¾ã—ãŸï¼ˆä½œæˆ: {created_count}ä»¶ã€æ›´æ–°: {updated_count}ä»¶ï¼‰'
        ))
        self.stdout.write(f'åˆè¨ˆ: {ConstructionType.objects.count()}ä»¶ã®å·¥ç¨®ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™')
        self.stdout.write('')
        self.stdout.write(self.style.NOTICE('â€» äºˆå‚™æ ã¯ç„¡åŠ¹çŠ¶æ…‹ã§ä½œæˆã•ã‚Œã¦ã„ã¾ã™'))
